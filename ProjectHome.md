Virtools串口通信BB编程，功能还不够完善，只作学习用。

之前做的一个Virtools串口通信BB，这个BB的功能还不是很完善，只能说有了一个基本的雏形。现在可以实现的功能是打开串口，读取字符，但是目前只能读取一个字符，而且还无法关闭串口。基本上还无法使用，但可以作为学习参考一下。
在开始之前，首先要学会用Windows API串口编程。在编写Virtools串口通信BB时，和利用Windows API进行串口编程的过程类似，不过编写Virtools BB时有一些它自己的过程。
这里就不讲如何使用Virtools SDK创建BB了，可以参考网上《Virtools开发之底层篇》这本书，书中介绍的很详细。在这里我使用的是Virtools 4.1和VC++ 2003的开发环境，应该要注意使用Virtools和VC++对应的版本号，否者可能会无法使用初始化向导。
开发环境搭建好后就可以开始了，首先要知道自己想要编出的BB是什么样子。这个例子中的BB很简单，只有一个输入端口、一个输出端口、一个输入参数和一个输出参数。输入参数对应着端口号，输出参数对应着串口读取到的值。
在利用向导设置好输入参数和输出参数后，在主程序中进行编程。其中最重要的函数是Virtools BB的功能实现函数。在功能实现函数中，实现Virtools BB对串口的打开、参数设置、读取串口。其中代码和利用Windows API进行串口编程的代码类似，不过都将所有的函数写在了一个函数中，其中还要注意的是Virtools BB的功能实现函数是循环执行的，所以要注意设置其中的串口打开、参数设置都只能执行一次。

原文连接：http://blog.163.com/hailin_xin/blog/static/21816219020135394857244/